<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1보후퇴-2보전진</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <style>
    /* 기존 스타일 유지 */

    /* 보드 스타일 */
    .board-container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: flex-start;
      gap: 20px;
      list-style: none;
      margin-top: 80px;
    }

    .board-card {
      width: 300px;
      height: 500px;
      margin-bottom: 20px;
      padding: 10px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .btn-invite {
      position: absolute; /* 상대적 위치 설정 */
      top: 10px; /* 위쪽 여백 설정 */
      right: 10px; /* 오른쪽 여백 설정 */
    }

    .board-card:hover {
      transform: scale(1.05);
    }

    .board-title {
      font-size: 2.3rem;
      font-weight: bold;
      margin: 10px auto;
      margin-bottom: 30px;
      width: 100%;
      text-align: center;
    }

    .board-content {
      font-size: 1.5rem;
      color: #333;
    }

    *{padding:0;margin:0}
    ul,ol{list-style:none}
    a{text-decoration:none;color:#fff;font-size:15px}
    nav{width:80%;overflow:hidden;height:80px;background-color:#1b2035;margin:50px auto}

    #nav3 {
      width: 100%;
      position: relative;
      text-align: right;
    }
    #nav3>a {
      line-height: 80px;
      display: block;
      font-size: 30px;
      font-weight: 900;
      position: absolute;
      left: 30px;
    }
    #nav3>select {
      padding: 0 20px;
      height: 30px;
      background-color: #1b2035;
      color: #fff;
      position: absolute;
      right: 30px;
      top: 50%;
      transform: translateY(-15px);
      border: 2px solid #fff;
      border-radius: 30px;
    }
    #nav3>ul {
      display: inline-block;
    }
    #nav3>ul li {
      float: left;
      line-height: 80px;
      padding: 0 30px;
    }


  </style>
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"
          integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
</head>
<body>
<nav id="nav3">
  <a href="index.html">1보후퇴-2보전진</a>
  <ul>
    <li><a href="/api/view/user/login">로그인</a></li>
    <li><a href="/api/view/user/signup">회원가입</a></li>
    <li><a href="/api/view/user/profile">프로필 수정</a></li>
    <li><a href="index.html">로그아웃</a></li>
  </ul>
</nav>

<div class="board-container" id="board-list">
  <!-- 보드 목록이 여기에 동적으로 추가될 것입니다. -->
</div>

<!-- 보드 초대 모달 -->
<div class="modal fade" id="inviteModal" tabindex="-1" aria-labelledby="inviteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="inviteModalLabel">유저 초대</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="text" id="userSearchInput" class="form-control" placeholder="유저 이름 검색">
        <button class="btn btn-success btn-sm btn-invite-user">초대</button> <!-- 초대 버튼 추가 -->
        <div id="userSearchResult"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
      </div>
    </div>
  </div>
</div>


<script>
  $(document).ready(function() {
    function fetchBoardList() {
      $.ajax({
        type: 'GET',
        url: '/api/boards', // 서버 API 엔드포인트로 수정해야 함
        contentType: 'application/json',
        success: function(response) {
          const boardList = response;
          const boardListElement = $('#board-list');

          boardListElement.empty();

          boardList.forEach(function(board) {
            const inviteButton = $('<button class="btn btn-primary btn-sm btn-invite" data-bs-toggle="modal" data-bs-target="#inviteModal">+</button>');

            const boardCard = $('<div class="board-card"></div>');
            const boardInfo = $('<div></div>');

            boardInfo.append($('<div class="board-title">' + board.boardName + '</div>'));
            boardInfo.append($('<div class="board-content">' + board.boardContents + '</div>'));

            boardCard.append(inviteButton);
            boardCard.append(boardInfo);
            boardListElement.append(boardCard);
          });
        },
        error: function(error) {
          console.error('Error fetching board list:', error);
        }
      });
    }

    fetchBoardList();
  });

  // 초대 버튼 클릭 시 이벤트 처리
  $(document).on('click', '.btn-invite', function() {
    // 검색창을 보여주는 부분
    $('#inviteModal').modal('show');
  });

  // 초대 버튼 클릭 시 이벤트 처리
  $(document).on('click', '.btn-invite-user', function() {
    const userSearchInput = $('#userSearchInput').val(); // 검색창의 입력값 가져오기

    if (userSearchInput) {
      // inviteBoard 메서드 호출
      $.ajax({
        type: 'POST',
        url: `/api/boards/invite/${userSearchInput}`, // 서버 API 엔드포인트로 수정해야 함
        success: function(response) {
          console.log(response.message); // 초대 성공 시 메시지 출력
          $('#inviteModal').modal('hide'); // 팝업 닫기
        },
        error: function(error) {
          console.error('Error inviting user:', error);
        }
      });
    }
  });
</script>
</body>
</html>
